{"version":3,"sources":["utils/misc.js","utils/schedule.js","components/ButtonSelect/index.js","components/FileInput/index.js","components/FeatureSideBar/index.js","components/MapMarkers/index.js","containers/MapBox/index.js","containers/NavBar/index.js","store/solution/selectors.js","store/settings/types.js","store/settings/actions.js","store/solution/types.js","store/solution/actions.js","App.js","store/settings/reducer.js","store/solution/reducer.js","store/reducers.js","index.js","store/index.js"],"names":["MAX_HUE","MIN_HUE","MAX_SAT","MIN_SAT","MAX_LIT","MIN_LIT","MAX_DISTANCE","genRandomColor","colors","cHue","cSat","cLit","isDistinct","hue","sat","lit","Math","abs","parsedColors","map","c","split","start","middle","end","Number","parseInt","floor","random","every","N_WORKDAYS","NamedWeeks","Array","from","length","_","i","NamedDays","resolveTime","time","hours","days","weeks","resolvedWeek","resolvedDay","resolvedHour","moment","duration","minutes","resolveWeekDay","day","colourStyles","control","styles","backgroundColor","option","data","isDisabled","isFocused","isSelected","color","chroma","alpha","css","contrast","cursor","multiValue","multiValueLabel","multiValueRemove","ButtonSelect","props","isActive","title","handleChange","onChange","getDaysByVehicles","getWeeksByVehicles","formatData","v","value","isArray","find","i2","includes","label","vehicle","className","onClick","isMulti","name","options","ops","FileInput","id","type","e","clickHandler","target","files","htmlFor","text","FeatureSideBar","state","isOpen","features","active","_selectActive","setState","_resolveHost","host","hosts","vehicles","hostIndexes","reduce","acc","h","originalId","push","routes","jobIndex","hostVehicle","steps","findIndex","s","job","arrival","this","activeFeatures","setActiveFeatures","currentFeature","customBurgerIcon","pageWrapId","outerContainerId","onStateChange","noOverlay","right","f","key","pickup","nContainers","perMonth","perWeek","nPickups","r","nextProps","prevState","f1","f2","some","undefined","p","Component","memo","hoverHandler","idx","latitude","longitude","order","markerStyles","fill","fontSize","textAnchor","strokeWidth","strokeLinejoin","transform","stroke","textColor","luminance","style","height","viewBox","MARKER_SIZE","d","x","y","prev","cur","prevData","prevType","curData","curType","dataLayer","source","paint","dataLayerInactive","beforeId","dataLayerBorder","Mapbox","activeVehicles","routesInactive","hostsInactive","depot","hoveredFeature","mapStyle","version","sources","tiles","window","location","protocol","tileSize","layers","minzoom","maxzoom","viewport","zoom","bearing","pitch","_handleViewportChange","width","_onHover","ev","srcEvent","offsetX","offsetY","hoveredFeatures","layer","af","properties","_onClick","filter","_getCursor","cursorState","isDragging","isHovering","left","top","showAllRoutes","interactiveLayerIds","onViewportChange","onHover","getCursor","_renderTooltip","a1","a2","activeFilter","vehicleColors","vehicleData","vehiclesPerDay","vehiclesPerWeek","a","vehiclesActive","vehiclesInactive","hostsActive","forEach","geometry","Polyline","toGeoJSON","vpd","week","vpw","resolvedActiveHosts","resolved","resolvedInactiveHosts","PureComponent","loadingContent","timeCalc","isEnd","earliest","sort","stepsA","stepsB","latest","NavBar","loadSolution","solutionStatus","vehiclesByDays","vehiclesByWeeks","setDays","setVehicles","setWeeks","setShowRoutes","activeDays","activeWeeks","emptyContent","WEEK","DAY","VEHICLE","checked","distance","distanceCalc","capacityCalc","hostsCalc","momentDur","durationCalc","getVehiclesByWeeks","flat","getVehiclesByDays","Set","vp","vw","Filters","setFilter","payload","dispatch","getState","solution","flatMap","w","daysFromWeeks","weeksFromDays","LoadStatus","setStatus","file","status","inputFile","Promise","resolve","reject","tempFileReader","FileReader","onerror","abort","onload","JSON","parse","result","readAsText","then","vroom","meta","output","vehicleCount","weekColors","dayColors","vd","genVehicleColors","catch","err","console","error","App","settings","connect","SolutionSelectors","SettingsActions","SolutionActions","initialState","rootReducer","combineReducers","store","createStore","reducer","applyMiddleware","thunk","initStore","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.21c14dbe.chunk.js","sourcesContent":["const MAX_HUE = 360;\nconst MIN_HUE = 0;\nconst MAX_SAT = 100;\nconst MIN_SAT = 80;\nconst MAX_LIT = 70;\nconst MIN_LIT = 40;\nconst MAX_DISTANCE = 25;\n\n/**\n * Generates a random color\n *  if colors is given, then attempts to generate a distinct color from those\n * \n * @param {} colors existant color dataset\n */\nexport function genRandomColor(colors) {\n  const isDistinct = ({ hue, sat, lit }, { cHue, cSat, cLit}) => {\n    const distHue = Math.abs( hue - cHue);\n    const distSat = Math.abs( sat - cSat);\n    const distLit = Math.abs( lit - cLit);\n\n    return (distHue + distSat + distLit) > MAX_DISTANCE;\n  };\n\n  const parsedColors = colors.map(c => {\n    const [start, middle, end] = c.split(',');\n    \n    return {\n      hue: Number.parseInt(start.split('hsl(')[1]),\n      sat: Number.parseInt(middle),\n      lit: Number.parseInt(end)\n    };\n  });\n\n\n  let cHue, cSat, cLit;\n  do {\n    cHue = Math.floor(Math.random() * (MAX_HUE - MIN_HUE) + MIN_HUE);\n    cSat = Math.floor(Math.random() * (MAX_SAT - MIN_SAT) + MIN_SAT);\n    cLit = Math.floor(Math.random() * (MAX_LIT - MIN_LIT) + MIN_LIT);\n\n  } while(!parsedColors.every(c => isDistinct(c, { cHue, cSat, cLit })));\n\n  return `hsl(${cHue}, ${cSat}%, ${cLit}%)`;\n}","import moment from 'moment';\n\nconst N_WORKDAYS = 5;\nconst N_WEEKS = 4;\n\nconst NamedWeeks = Array.from({ length: N_WEEKS}, (_, i) => `Week ${i + 1}`);\nconst NamedDays = [\n  'Mon',\n  'Tue',\n  'Wed',\n  'Thu',\n  'Fri'\n];\n\n/**\n * Resolves array of day indices for given week indices array\n * \n * @param {Number[]} weeks\n *    [0, 2] = first week, third week days => [0..4, 10..14]\n *    [1, 3] = second week, fourth week days => [5..9, 15..19]\n */\nexport function daysFromWeeks(weeks) {\n  return weeks.flatMap(w => Array.from({ length: N_WORKDAYS }, (_, i) => i + w * 5));\n}\n\n/**\n * Resolves array of unique week indices for given days indices array\n * \n * @param {Number[]} days \n *    [0, 1, 2, 10, 11] => first week, third week => [0, 2]\n *    [5, 8, 15] = second week, fourth week => [1, 3]\n */\nexport function weeksFromDays(days) {\n  return Array.from(new Set(days.map(d => Math.floor(d / N_WORKDAYS))));\n}\n\n/**\n * Resolve \n * @param {*} time \n */\nexport function resolveTime(time) {\n  let hours = time / 60 / 60;\n  let days = hours / 24;\n  let weeks = days / N_WORKDAYS;\n\n  if (days > N_WORKDAYS) {\n\n  }\n\n  if (days > 1) {\n    hours = hours % 24;\n  }\n\n  if (weeks > 1) {\n    days = days % N_WORKDAYS;\n  }\n\n  const resolvedWeek = NamedWeeks[Math.floor(weeks)];\n  const resolvedDay = NamedDays[Math.floor(days)];\n  const resolvedHour = `${moment.duration(hours, 'hours').hours()}h${moment.duration(hours, 'hours').minutes()}m`;\n  \n  return `${resolvedWeek}, ${resolvedDay} - ${resolvedHour}`;\n}\n\nexport function resolveWeekDay(day, fromIndex=true) {\n  if (fromIndex) {\n    return NamedDays[Math.floor(day % N_WORKDAYS)];\n  }\n\n  const hours = day / 60 / 60;\n  let days = hours / 24;\n  const weeks = days / N_WORKDAYS;\n\n  if (weeks > 1) {\n    days = days % N_WORKDAYS;\n  }\n\n  return NamedDays[Math.floor(days)];\n}\n","import React from 'react';\nimport Select from 'react-select';\nimport chroma from 'chroma-js';\n\nimport { resolveWeekDay } from '../../utils';\n\nimport './style.css';\n\nconst colourStyles = {\n  control: styles => ({ ...styles, backgroundColor: 'white' }),\n  option: (styles, { data, isDisabled, isFocused, isSelected }) => {\n    const color = chroma(data.color);\n    return {\n      ...styles,\n      backgroundColor: isDisabled\n        ? null\n        : isSelected\n        ? data.color\n        : isFocused\n        ? color.alpha(0.1).css()\n        : null,\n      color: isDisabled\n        ? '#ccc'\n        : isSelected\n        ? chroma.contrast(color, 'white') > 2\n          ? 'white'\n          : 'black'\n        : data.color,\n      cursor: isDisabled ? 'not-allowed' : 'default',\n\n      ':active': {\n        ...styles[':active'],\n        backgroundColor: !isDisabled && (isSelected ? data.color : color.alpha(0.3).css()),\n      },\n    };\n  },\n  multiValue: (styles, { data }) => {\n    const color = chroma(data.color);\n    return {\n      ...styles,\n      backgroundColor: color.alpha(0.1).css(),\n    };\n  },\n  multiValueLabel: (styles, { data }) => ({\n    ...styles,\n    color: data.color,\n  }),\n  multiValueRemove: (styles, { data }) => ({\n    ...styles,\n    color: data.color,\n    ':hover': {\n      backgroundColor: data.color,\n      color: 'white',\n    },\n  }),\n};\n\nconst ButtonSelect = (props) => {\n  const {\n    data,\n    colors,\n    isActive,\n    title,\n    onChange: handleChange,\n\n    getDaysByVehicles,\n    getWeeksByVehicles\n  } = props;\n\n  const formatData = data.map((v, i) => ({\n    value: i,\n    color: Array.isArray(v) ? colors.find((_, i2) => v.includes(i2)) : colors[i],\n    label: `${i+1} \n      ${getDaysByVehicles ? `${resolveWeekDay(getDaysByVehicles([v.vehicle])[0])}` : ''}\n      ${getWeeksByVehicles ? `W${getWeeksByVehicles([v.vehicle])[0] + 1}` : ''}`\n  }));\n\n  return (\n    <div className='ButtonSelect'>\n      <span onClick={() => handleChange(data.map((_, i) => i))} className={`ButtonSelect-Title ${isActive && 'active'}`}>{title}</span>\n\n      <Select\n        styles={colourStyles}\n        isMulti\n        name={title}\n        options={formatData}\n        onChange={ops => handleChange(ops && ops.length > 0 ? ops.map(({ value }) => value) : data.map((_, i) => i))}\n        />\n    </div>\n  );\n}\n\nexport default ButtonSelect;\n","import React, { Fragment } from 'react';\n\nimport './style.css';\n\nconst FileInput = (props) => {\n  return (\n    <Fragment>\n      <input\n        id=\"file\"\n        className=\"FileInput\"\n        name=\"file\"\n        type=\"file\"\n        onChange={e => props.clickHandler(e.target.files[0])}/>\n      <label htmlFor=\"file\">{props.text}</label>\n    </Fragment>\n  );\n}\n\nexport default FileInput;","import React, { Component, Fragment } from 'react';\nimport { slide as Menu } from 'react-burger-menu';\n\nimport { resolveTime } from '../../utils';\n\nimport './style.css';\n\nexport default class FeatureSideBar extends Component {\n  state = {\n    isOpen: false,\n    features: [],\n    active: null\n  }\n\n  static getDerivedStateFromProps(nextProps, prevState) {\n    const { activeFeatures } = nextProps;\n    const { features } = prevState;\n    debugger;\n    const isDistinct = (f1, f2) => (f1 && f2) && f1.some(f => f2.find(p => (p.id === f.id) && (p.type === f.type)) === undefined);\n\n    if (activeFeatures && activeFeatures.length === 0) {\n      return { isOpen: false, features: [], active: null };\n    }\n\n    if (isDistinct(activeFeatures, features)) {\n      return {\n        features: activeFeatures,\n        isOpen: true,\n        active: activeFeatures.length > 1 ? null : 0\n      };\n    }\n\n    return null;\n  }\n\n  _selectActive = active => {\n    this.setState({ active })\n  }\n\n  _resolveHost = host => {\n    const { hosts, vehicles } = this.props;\n    const hostIndexes = hosts.reduce((acc, h, originalId) => {\n      if (h.host === host) {\n        acc.push({...h, originalId });\n      }\n\n      return acc;\n    }, []);\n\n    const routes = hostIndexes.reduce((acc, h) => {\n      let jobIndex;\n      const hostVehicle = vehicles.find(v =>\n        (jobIndex = v.steps.findIndex(s => s.type === 'job' && s.job === h.originalId)) !== -1\n      );\n\n      acc.push({\n        vehicle: hostVehicle.vehicle,\n        time: resolveTime(hostVehicle.steps[jobIndex].arrival)\n      });\n\n      return acc;\n    }, []);\n\n    return {\n      ...hostIndexes[0],\n      routes\n    };\n  }\n\n  render() {\n    const {\n      activeFeatures,\n      vehicles,\n      hosts,\n      setActiveFeatures\n    } = this.props;\n\n    const {\n      active,\n      features,\n      isOpen\n    } = this.state;\n\n    const currentFeature = active !== null && ({\n      ...features[active],\n      ...(\n        features[active].type === 'vehicle'\n          ? { id: features[active].id + 1, ...vehicles[features[active].id] }\n          : this._resolveHost(features[active].id)\n      )\n    });\n\n    return (\n      <Menu\n        customBurgerIcon={false}\n        isOpen={this.state.isOpen}\n        pageWrapId={'main-content'}\n        outerContainerId={'App'}\n        onStateChange={({ isOpen }) => !isOpen && setActiveFeatures()}\n        noOverlay\n        right >\n\n        {\n          activeFeatures && activeFeatures.length > 1 ?\n            <ul>\n              {\n                activeFeatures.map((f, i) =>\n                  <li key={i} className={`FeatureLink ${active === i ? 'active' : ''}`} onClick={() => this._selectActive(i)}>\n                    {f.type} - {f.id + 1}\n                  </li>\n                )\n              }\n            </ul>\n            : null\n        }\n\n        {\n          currentFeature && isOpen ?\n            <Fragment>\n              <h1>\n                <span className='SideBar-Title'>{currentFeature.type}</span>\n                { currentFeature.id }\n              </h1>\n              <div className='SideBar-Stats'>\n                {\n                  currentFeature.type === 'vehicle' ?\n                    <Fragment>\n                      <span>\n                        <b>Hosts:</b> {currentFeature.steps.length - 2}\n                      </span>\n                      <span>\n                        <b>Capacity:</b> {currentFeature.pickup[0]} / 21\n                      </span>\n                    </Fragment>\n                    : <Fragment>\n                      <span>\n                        <b># Containers</b> {currentFeature.nContainers}\n                      </span>\n                      <span>\n                        <b>Freq:</b> {currentFeature.perMonth}{currentFeature.perMonth === 7 ? `.${currentFeature.perWeek}` : null }\n                      </span>\n                      <span>\n                        <b># Pickups:</b> {currentFeature.nPickups}\n                      </span>\n                    </Fragment>\n                }\n              </div>\n              <h3>Routes: </h3>\n              <ul>\n                {\n                  currentFeature.type === 'vehicle' ?\n                  currentFeature.steps.map((s, i) => {\n                    const {\n                      host,\n                      pickup,\n                      perMonth,\n                      perWeek,\n                      nContainers,\n                      nPickups\n                    } = s.type === 'job' && hosts[s.job];\n\n                    return (\n                      <li key={i} className='Feature'>\n                        {\n                          s.type !== 'job' ?\n                            <Fragment>\n                              <div className='Feature-Title'>{s.type}</div>\n                              <small><b>Arrival: </b>{resolveTime(s.arrival)}</small>\n                            </Fragment> :\n                            <Fragment>\n                              <div className='Feature-Title FeatureLink'\n                                onClick={() => s.type === 'job' && setActiveFeatures([{ type: 'host', id: host }])}>\n                                {host}\n                                <small>{perMonth}{perMonth === 7 ? `.${perWeek}` : null }</small>\n                              </div>\n                              <small><b># Containers: </b>{nContainers}</small>\n                              <br />\n                              <small><b>Pickup Nr: </b>{pickup + 1} / {nPickups}</small>\n                              <br />\n                              <small><b>Arrival: </b>{resolveTime(s.arrival)}</small>\n                            </Fragment>\n                        }\n                      </li>\n                    );\n                  })\n                  : currentFeature.type === 'host' ?\n                    currentFeature.routes.map((r, i) => {\n                      const { vehicle, time } = r;\n\n                      return (\n                        <li className='Feature' key={i}>\n                          <div className='Feature-Title FeatureLink'\n                            onClick={() => setActiveFeatures([{ type: 'vehicle', id: vehicle }])}>\n                            Vehicle {vehicle + 1}\n                          </div>\n                          <small>{time}</small>\n                        </li>\n                      );\n                    })\n                  : null\n                }\n              </ul>\n            </Fragment>\n            : null\n        }\n    </Menu>\n    );\n  }\n}","import React, { memo } from 'react';\nimport { Marker } from 'react-map-gl';\nimport chroma from 'chroma-js';\n\nconst COLOR_INACTIVE = '#000000';\nconst COLOR_DEPOT = '#FF0000';\n\nconst MARKER_SIZE = 20;\nconst MARKER_ICON = `M20.2,15.7L20.2,15.7c1.1-1.6,1.8-3.6,1.8-5.7c0-5.6-4.5-10-10-10S2,4.5,2,10c0,2,0.6,3.9,1.6,5.4c0,0.1,0.1,0.2,0.2,0.3\n  c0,0,0.1,0.1,0.1,0.2c0.2,0.3,0.4,0.6,0.7,0.9c2.6,3.1,7.4,7.6,7.4,7.6s4.8-4.5,7.4-7.5c0.2-0.3,0.5-0.6,0.7-0.9\n  C20.1,15.8,20.2,15.8,20.2,15.7z`;\n\nconst MapMarkers = (props) => {\n  const {\n    data,\n    type,\n    \n    clickHandler,\n    hoverHandler\n  } = props;\n\n  return data.map(({ color, host, latitude, longitude, order }, idx) => {\n\n    const markerStyles = {\n      cursor: 'pointer',\n      fill: color || (type === 'depot' && COLOR_DEPOT) || COLOR_INACTIVE,\n      fontSize: '12px',\n      textAnchor: 'middle',\n      strokeWidth: 1,\n      strokeLinejoin: 'round',\n      transform: `translate(${-MARKER_SIZE / 2}px,${-MARKER_SIZE}px)`\n    };\n    markerStyles.stroke = markerStyles.fill === COLOR_INACTIVE ? 'white' : 'black';\n  \n    const textColor = chroma(markerStyles.fill).luminance() > 0.6 ? '#000' : '#fff';\n\n    return (\n      <Marker key={`marker-${type}-${host || idx}`}\n        longitude={longitude}\n        latitude={latitude}>\n\n        <svg style={{...markerStyles}}\n          height={MARKER_SIZE}\n          viewBox={`0 0 ${MARKER_SIZE + 4} ${MARKER_SIZE + 4}`}\n          onClick={type !== 'depot' ? (() => clickHandler([{ type, id: host }])) : null}>\n\n          <path d={MARKER_ICON} />\n          <text x='50%' y='50%' stroke={textColor}>\n            { type === 'depot' ? 'D' : order}\n          </text>\n        </svg>\n\n      </Marker>\n    );\n  });\n}\n\nconst arePropsEqual = (prev, cur) => {\n  const { prevData, prevType } = prev;\n  const { curData, curType } = cur;\n\n  return (\n    prev && cur\n    && prevData && curData\n    && prevType === curType\n    && prevData.length === curData.length\n  );\n}\n\nexport default memo(MapMarkers, arePropsEqual);","import React, { PureComponent } from 'react';\nimport MapGL, { Layer, Source } from 'react-map-gl';\n\nimport Polyline from '@mapbox/polyline';\n\nimport { MapMarkers } from '../../components';\n\nimport './style.css';\nimport 'mapbox-gl/dist/mapbox-gl.css';\n\nconst arrayEquals = (a1, a2) => a1.length === a2.length && a1.every(a => a2.includes(a));\n\nconst COLOR_INACTIVE = '#000000';\n\nconst dataLayer = {\n  id: 'data',\n  type: 'line',\n  source: 'routes',\n  paint: {\n    'line-width': 3,\n    // Use a get expression (https://docs.mapbox.com/mapbox-gl-js/style-spec/#expressions-get)\n    // to set the line-color to a feature property value.\n    'line-color': ['get', 'color']\n  }\n};\n\nconst dataLayerInactive = {\n  id: 'dataInactive',\n  type: 'line',\n  beforeId: 'data',\n  source: 'routesInactive',\n  paint: {\n    'line-width': 3,\n    'line-color': COLOR_INACTIVE\n  }\n};\n\nconst dataLayerBorder = {\n  id: 'dataBorder',\n  beforeId: 'data',\n  type: 'line',\n  source: 'routes',\n  paint: {\n    'line-width': 5,\n    'line-color': '#000000'\n  }\n};\n\nexport default class Mapbox extends PureComponent {\n  state = {\n    activeVehicles: [],\n    routes: null,\n    routesInactive: null,\n    hosts: [],\n    hostsInactive: [],\n    depot: null,\n\n    // Map Config\n    hoveredFeature: null,\n    mapStyle: {\n      version: 8,\n      sources: {\n        'raster-tiles': {\n            type: 'raster',\n            tiles: [\n              `${window.location.protocol}//tile.osm.org/{z}/{x}/{y}.png`\n            ],\n            tileSize: 256\n        }\n      },\n      layers: [{\n          id: \"test\",\n          type: \"raster\",\n          source: \"raster-tiles\",\n          minzoom: 0,\n          maxzoom: 22\n      }]\n    },\n    viewport: {\n      latitude: 40,\n      longitude: -7,\n      zoom: 4,\n      bearing: 0,\n      pitch: 0\n    }\n  }\n\n  static getDerivedStateFromProps(nextProps, { activeVehicles: prev }) {\n    const {\n      activeVehicles: cur,\n      activeFilter,\n      vehicleColors,\n      vehicles: vehicleData,\n      vehiclesPerDay,\n      vehiclesPerWeek,\n      hosts\n    } = nextProps;\n\n    if (cur && cur.length > 0 && vehicleData && vehicleData.length > 0 &&\n      !arrayEquals(cur, prev) ) {\n        const vehiclesActive = [];\n        const vehiclesInactive = [];\n        const hostsActive = [];\n        const hostsInactive = [];\n\n        const [longitude, latitude] = vehicleData[0].steps[0].location;\n        const depot = { longitude, latitude };\n\n        vehicleData.forEach((v, i) => {\n          const { steps, vehicle } = v;\n\n          if (cur.includes(i)) {\n            vehiclesActive.push(v);\n            steps.forEach(({ job }, order) => job !== undefined && hostsActive.push({ job, vehicle, order }));\n          } else {\n            vehiclesInactive.push(v);\n            steps.forEach(({ job }) => job !== undefined && hostsInactive.push({ job, vehicle }));\n          }\n        });\n\n        const routes = {\n          type: 'FeatureCollection',\n          features: vehiclesActive.map(v => ({\n            type: 'Feature',\n            geometry: Polyline.toGeoJSON(v.geometry),\n            properties: {\n              vehicle: v.vehicle,\n              color: vehicleColors[v.vehicle][activeFilter],\n              day: vehiclesPerDay.findIndex(vpd => vpd.includes(v.vehicle)),\n              week: vehiclesPerWeek.findIndex(vpw => vpw.includes(v.vehicle))\n            }\n          }))\n        };\n\n        const routesInactive = {\n          type: 'FeatureCollection',\n          features: vehiclesInactive.map(v => ({\n            type: 'Feature',\n            geometry: Polyline.toGeoJSON(v.geometry),\n            properties: {\n              vehicle: v.vehicle,\n              day: vehiclesPerDay.findIndex(vpd => vpd.includes(v.vehicle)),\n              week: vehiclesPerWeek.findIndex(vpw => vpw.includes(v.vehicle))\n            }\n          }))\n        };\n\n        const resolvedActiveHosts = hostsActive.reduce((acc, h) => {\n          const { job, order, vehicle } = h;\n          const resolved = hosts[job];\n\n          if (acc.find(({ host }) => host === resolved.host) === undefined) {\n            acc.push({ ...resolved, color: vehicleColors[vehicle][activeFilter], order });\n          }\n          return acc;\n        }, []);\n\n        const resolvedInactiveHosts = hostsInactive.reduce((acc, h) => {\n          const { job } = h;\n          const resolved = hosts[job];\n\n          if (acc.find(({ host }) => host === resolved.host) === undefined) {\n            acc.push({ ...resolved, color: COLOR_INACTIVE });\n          }\n          return acc;\n        }, []);\n\n        return {\n          activeVehicles: cur,\n          depot,\n          routes,\n          routesInactive,\n          hosts: resolvedActiveHosts,\n          hostsInactive: resolvedInactiveHosts\n        };\n      }\n\n    return null;\n  }\n\n  _handleViewportChange = ({ width, height, ...viewport }) => this.setState({ viewport: { ...this.state.viewport, ...viewport } });\n\n  _onHover = ev => {\n    const {\n      features,\n      srcEvent: { offsetX, offsetY }\n    } = ev;\n\n    const hoveredFeatures = features && features.reduce((acc, f) => {\n      if (\n        (f.layer.id === 'data' || f.layer.id === 'dataInactive')\n        && (acc.find(af => af.properties.vehicle === f.properties.vehicle) === undefined)\n      ) { acc.push(f); }\n      return acc;\n    }, []);\n\n    this.setState({\n      hoveredFeatures,\n      x: offsetX, y: offsetY\n    });\n  }\n\n  _onClick = ev => {\n    const { features } = ev;\n    const { setActiveFeatures } = this.props;\n    const activeFeatures = features && features.filter(f => f.layer.id === 'data' || f.layer.id === 'dataInactive');\n\n    if (activeFeatures) {\n      // setActiveFeature({ type: 'vehicle', id: activeFeature.properties.vehicle });\n      setActiveFeatures(activeFeatures.map(f => ({ type: 'vehicle', id: f.properties.vehicle })))\n    } else {\n      setActiveFeatures();\n    }\n  }\n\n  _getCursor = cursorState => {\n    const { isDragging, isHovering } = cursorState;\n\n    return isDragging ?\n      'grabbing'\n      : isHovering ?\n      'pointer' : 'default'\n  }\n  \n  _renderTooltip() {\n    const {hoveredFeatures, x, y} = this.state;\n\n    if (!hoveredFeatures || !hoveredFeatures.length) {\n      return null;\n    }\n\n    return (\n      <div className='Tooltip' style={{left: x, top: y}}>\n        {\n          hoveredFeatures.length > 1 && <div>Count: {hoveredFeatures.length}</div>\n        }\n        <div>Vehicles: </div>\n        <div className='Tooltip-VehicleHolder'>\n          { hoveredFeatures.map((f, i) => <span key={i}>{f.properties.vehicle + 1}</span>) }\n        </div>\n      </div>\n    );\n  }\n\n  render() {\n    const {\n      mapStyle,\n      routes,\n      routesInactive,\n      viewport,\n\n      hosts,\n      hostsInactive,\n      depot\n    } = this.state;\n\n    const {\n      setActiveFeatures,\n      showAllRoutes\n    } = this.props\n\n    return (\n      <div id=\"map\">\n        <MapGL\n          mapStyle={mapStyle}\n          height='100%'\n          width='100%'\n          interactiveLayerIds={[dataLayer.id, ...(showAllRoutes ? [dataLayerInactive.id] : [])]}\n          onViewportChange={this._handleViewportChange}\n          onHover={this._onHover}\n          onClick={this._onClick}\n          getCursor={this._getCursor}\n          {...viewport}>\n            <Source id='routes' type='geojson' data={routes}>\n              <Layer {...dataLayer} />\n              <Layer {...dataLayerBorder} />\n            </Source>\n            {\n              showAllRoutes ?\n                <Source id='routesInactive' type='geojson' data={routesInactive}>\n                  <Layer {...dataLayerInactive} />\n                </Source>\n                : null\n            }\n            {\n              depot ?\n                <MapMarkers data={[depot]} type='depot'/>\n                : null\n            }\n                        {\n              showAllRoutes ?\n                <MapMarkers data={hostsInactive} type='inactive' clickHandler={setActiveFeatures} />\n                : null\n            }\n            <MapMarkers data={hosts} type='host' clickHandler={setActiveFeatures}/>\n            {this._renderTooltip()}\n        </MapGL>\n      </div>\n    );\n  }\n};","import React, { Fragment } from 'react';\n\nimport moment from 'moment';\n\nimport { ButtonSelect, FileInput } from '../../components';\n\nimport { resolveTime } from '../../utils';\n\nimport './style.css';\n\nconst loadingContent = (\n  <p>Loading...</p>\n);\n\nconst emptyContent = loadSolution => (\n  <Fragment>\n    <FileInput text='Load Solution' clickHandler={loadSolution} />\n  </Fragment>\n);\n\nconst distanceCalc = (vehicles, active) => {\n  const activeVehicles = vehicles.filter(v => active.includes(v.vehicle));\n\n  return activeVehicles.reduce((acc, v) => acc + v.distance, 0);\n}\n\nconst capacityCalc = (vehicles, active) => {\n  const activeVehicles = vehicles.filter(v => active.includes(v.vehicle));\n\n  return activeVehicles.reduce((acc, v) => acc + v.pickup[0], 0);\n}\n\nconst timeCalc = (vehicles, active, isEnd = false) => {\n  const activeVehicles = vehicles.filter(v => active.includes(v.vehicle));\n  const earliest = activeVehicles.sort(({steps: stepsA}, {steps: stepsB}) => stepsA[0].arrival - stepsB[0].arrival)[0];\n  const latest = activeVehicles.sort(({steps: stepsA}, {steps: stepsB}) => stepsB[stepsB.length - 1].arrival - stepsA[stepsA.length - 1].arrival)[0];\n\n  if (!earliest || !latest) {\n    return 0;\n  }\n\n  const { arrival } = isEnd ? latest.steps[latest.steps.length - 1] : earliest.steps[0];\n\n  return arrival;\n}\n\nconst hostsCalc = (vehicles, active) => {\n  const activeVehicles = vehicles.filter(v => active.includes(v.vehicle));\n\n  return activeVehicles.reduce((acc, v) => acc + v.steps.length - 2, 0);\n}\n\nconst durationCalc = (vehicles, active) => {\n  const activeVehicles = vehicles.filter(v => active.includes(v.vehicle));\n  const duration = activeVehicles.reduce((acc, v) => acc + v.duration, 0);\n  const momentDur = moment.duration(duration, 's');\n  const days = momentDur.days();\n  const hours = momentDur.hours();\n  const minutes = momentDur.minutes();\n\n  //return `${momentDur.days()}d:${momentDur.hours()}h:${momentDur.minutes()}m`\n  return `${days ? days + 'd' : ''} ${hours ? hours + 'h' : ''} ${minutes ? minutes + 'm' : ''}`\n}\n\nconst NavBar = (props) => {\n  const {\n    loadSolution,\n    solutionStatus,\n    vehiclesPerDay,\n    vehiclesPerWeek,\n    vehicles,\n\n    // Selectors\n    vehiclesByDays,\n    vehiclesByWeeks,\n    getDaysByVehicles,\n    getWeeksByVehicles,\n\n    // Setters\n    setDays,\n    setVehicles,\n    setWeeks,\n    setShowRoutes,\n\n    // Filters\n    activeFilter,\n    activeVehicles,\n    activeDays,\n    activeWeeks,\n    showAllRoutes,\n    vehicleColors\n  } = props;\n\n  return (\n    <header className='NavBar'>\n      {\n        (solutionStatus === 'EMPTY' && emptyContent(loadSolution)) ||\n        (solutionStatus === 'LOADING' && loadingContent) ||\n        <Fragment>\n          <div className='NavBar-Controls'>\n            <ButtonSelect title='Weeks' isActive={activeFilter === 'WEEK'}\n              data={vehiclesPerWeek} colors={vehicleColors.map(({ WEEK }) => WEEK)} onChange={setWeeks} />\n\n            <ButtonSelect title='Days' isActive={activeFilter === 'DAY'}\n              data={vehiclesPerDay} colors={vehicleColors.map(({ DAY }) => DAY)} onChange={setDays} />\n\n            <ButtonSelect title='Vehicles' isActive={activeFilter === 'VEHICLE'}\n              data={vehicles} colors={vehicleColors.map(({ VEHICLE }) => VEHICLE)} onChange={setVehicles}\n              getWeeksByVehicles={getWeeksByVehicles} getDaysByVehicles={getDaysByVehicles} />\n\n            <div>\n              <label>\n              <input\n                name='showAllRoutes'\n                type='checkbox'\n                checked={showAllRoutes}\n                onChange={({ target }) => setShowRoutes(target.checked)}\n                />\n                Show inactive routes\n              </label>\n            </div>\n          </div>\n            \n          <div className='NavBar-Stats'>\n            <span className='NavBar-StatsField'>\n              <label>Vehicles:</label>\n              <span>{activeVehicles.length}</span>\n            </span>\n            <span className='NavBar-StatsField'>\n              <label>Distance:</label>\n              <span>{`${distanceCalc(vehicles, activeVehicles) / 1000 } Km`}</span>\n            </span>\n            <span className='NavBar-StatsField'>\n              <label>Capacity:</label>\n              <span>{capacityCalc(vehicles, activeVehicles)}</span>\n            </span>\n            <span className='NavBar-StatsField'>\n              <label>Hosts:</label>\n              <span>{hostsCalc(vehicles, activeVehicles)}</span>\n            </span>\n            <span className='NavBar-StatsField'>\n              <label>Start:</label>\n              <span>{resolveTime(timeCalc(vehicles, activeVehicles))}</span>\n            </span>\n            <span className='NavBar-StatsField'>\n              <label>End:</label>\n              <span>{resolveTime(timeCalc(vehicles, activeVehicles, true))}</span>\n            </span>\n            <span className='NavBar-StatsField'>\n              <label>Duration:</label>\n              <span>{durationCalc(vehicles, activeVehicles)}</span>\n            </span>\n          </div>\n        </Fragment>\n      }\n    </header>\n  );\n}\n\nexport default NavBar;","export const getVehiclesByWeeks = (state, weeks) => {\n  const vehicles = state.vehiclesPerWeek.filter((_, i) => weeks.includes(i));\n\n  return vehicles.flat();\n}\n\nexport const getVehiclesByDays = (state, days) => {\n  const vehicles = state.vehiclesPerDay.filter((_, i) => days.includes(i));\n\n  return vehicles.flat();\n}\n\nexport const getDaysByVehicles = (state, vehicles) => {\n  const days = new Set(vehicles.map(v => Number.parseInt(state.vehiclesPerDay.findIndex(vp => vp.includes(v)))));\n\n  return Array.from(days);\n};\n\nexport const getWeeksByVehicles = (state, vehicles) => {\n  const weeks = new Set(vehicles.map(v => state.vehiclesPerWeek.findIndex(vw => vw.includes(v))));\n\n  return Array.from(weeks);\n};","export const SET_FILTER = 'SET_FILTER';\nexport const SET_VEHICLE_COLORS = 'SET_VEHICLE_COLORS';\nexport const SET_ACTIVE_FEATURES = 'SET_ACTIVE_FEATURES';\nexport const SET_SHOW_ROUTES = 'SET_SHOW_ROUTES';\n\nexport const Filters = {\n  WEEK: 'WEEK',\n  DAY: 'DAY',\n  VEHICLE: 'VEHICLE'\n};\n","import { daysFromWeeks, weeksFromDays, genRandomColor } from '../../utils';\nimport {\n  getVehiclesByWeeks,\n  getVehiclesByDays,\n  getWeeksByVehicles,\n  getDaysByVehicles\n} from '../solution/selectors';\n\nimport {\n  SET_ACTIVE_FEATURES,\n  SET_FILTER,\n  SET_VEHICLE_COLORS,\n  Filters,\n  SET_SHOW_ROUTES\n} from './types';\n\nconst setFilter = (activeDays, activeWeeks, activeFilter, activeVehicles) => ({\n  type: SET_FILTER,\n  payload: {\n    activeDays,\n    activeWeeks,\n    activeFilter,\n    activeVehicles\n  }\n});\n\nexport const setShowRoutes = showAllRoutes => (dispatch) => {\n  return dispatch({\n    type: SET_SHOW_ROUTES,\n    payload: { showAllRoutes }\n  });\n}\n\nexport const setActiveFeatures = features => (dispatch) => {\n  return dispatch({\n    type: SET_ACTIVE_FEATURES,\n    payload: features\n  });\n}\n\nexport const genVehicleColors = (vehiclesPerDay, vehiclesPerWeek, vehicleCount) => (dispatch) => {\n  \n  const weekColors = vehiclesPerWeek.reduce((acc, _) => {\n    acc.push(genRandomColor(acc));\n    return acc;\n  }, []);\n  const dayColors = vehiclesPerDay.reduce((acc, _) => {\n    acc.push(genRandomColor(acc));\n    return acc;\n  }, []);\n  const vehicleColors = Array.from({ length: vehicleCount }, (_, i) => i).reduce((acc, v) => {\n    const week = vehiclesPerWeek.findIndex(vw => vw.includes(v));\n    const day = vehiclesPerDay.findIndex(vd => vd.includes(v));\n\n    acc.push({\n      [Filters.DAY]: dayColors[day],\n      [Filters.WEEK]: weekColors[week],\n      [Filters.VEHICLE]: genRandomColor(acc.map(({ VEHICLE: vc }) => vc ))\n    });\n\n    return acc;\n  }, []);\n  \n  return dispatch({\n    type: SET_VEHICLE_COLORS,\n    payload: { vehicleColors }\n  });\n}\n\nexport const setWeeks = weeks => (dispatch, getState) => {\n  const activeVehicles = getVehiclesByWeeks(getState().solution, weeks);\n  const activeDays = daysFromWeeks(weeks);\n  const activeFilter = Filters.WEEK;\n\n  return dispatch(setFilter(activeDays, weeks, activeFilter, activeVehicles));\n};\n\nexport const setDays = days => (dispatch, getState) => {\n  const activeVehicles = getVehiclesByDays(getState().solution, days);\n  const activeWeeks = weeksFromDays(days);\n  const activeFilter = Filters.DAY;\n\n  return dispatch(setFilter(days, activeWeeks, activeFilter, activeVehicles));\n};\n\nexport const setVehicles = vehicles => (dispatch, getState) => {\n  const activeFilter = Filters.VEHICLE;\n  const activeDays = getDaysByVehicles(getState().solution, vehicles);\n  const activeWeeks = getWeeksByVehicles(getState().solution, vehicles);\n\n  return dispatch(setFilter(activeDays, activeWeeks, activeFilter, vehicles));\n}","export const LOAD_SOLUTION = 'LOAD_SOLUTION';\nexport const SET_STATUS = 'SET_STATUS';\n\nexport const LoadStatus = {\n  EMPTY: 'EMPTY',\n  LOADING: 'LOADING',\n  DONE: 'DONE'\n};","import { LOAD_SOLUTION, SET_STATUS, LoadStatus } from './types';\n\nimport { genVehicleColors, setWeeks } from '../settings/actions';\n\nconst readJSONFile = inputFile => new Promise((resolve, reject) => {\n    const tempFileReader = new FileReader();\n\n    tempFileReader.onerror = () => {\n      tempFileReader.abort();\n      reject('Problem parsing input file');\n    };\n\n    tempFileReader.onload = () => {\n      resolve(JSON.parse(tempFileReader.result));\n    };\n    tempFileReader.readAsText(inputFile);\n});\n\n\n// Actions\nconst setStatus = payload => ({\n  type: SET_STATUS,\n  payload\n});\n\n\n// Action Creators\nexport const loadSolution = file => (dispatch) => {\n  dispatch(setStatus({ status: LoadStatus.LOADING }));\n\n  return readJSONFile(file)\n  .then(data => {\n    const { vroom, meta } = data;\n    const { routes: vehicles } = vroom.output;\n    const { hosts, vehiclesPerDay, vehiclesPerWeek } = meta;\n\n    // Call vehicle color generation from settings actions\n    dispatch(genVehicleColors(vehiclesPerDay, vehiclesPerWeek, vehicles.length));\n\n    // dispatch(setVehicles(vehicles.map((_, i) => i)));\n    dispatch(setWeeks(vehiclesPerWeek.map((_, i) => i)))\n\n    return dispatch({\n      type: LOAD_SOLUTION,\n      payload: {\n        hosts,\n        vehicles,\n        vehiclesPerDay,\n        vehiclesPerWeek\n      }\n    });\n    })\n    .catch(err => {\n      console.error(err);\n      return dispatch(setStatus(LoadStatus.EMPTY));\n    });\n};","import React, { Component } from 'react';\nimport { connect } from 'react-redux';\n\nimport { Mapbox, NavBar } from './containers';\nimport { FeatureSideBar } from './components';\nimport './App.css';\n\nimport * as SettingsActions from './store/settings/actions';\nimport * as SolutionActions from './store/solution/actions';\n\nimport * as SolutionSelectors from './store/solution/selectors';\n\nclass App extends Component {\n  state = {\n  }\n  \n  render() {\n    const {\n      settings,\n      solution,\n      loadSolution,\n\n      // Filter setters\n      setDays,\n      setVehicles,\n      setWeeks,\n      setShowRoutes,\n\n      setActiveFeatures\n    } = this.props;\n\n    const {\n      status: solutionStatus,\n      vehiclesPerDay,\n      vehiclesPerWeek,\n      vehicles,\n      hosts,\n\n      // Selectors\n      getVehiclesByDays,\n      getVehiclesByWeeks,\n      getDaysByVehicles,\n      getWeeksByVehicles\n    } = solution;\n\n    const {\n      // Filters\n      activeFeatures,\n      activeVehicles,\n      activeFilter,\n      activeDays,\n      activeWeeks,\n      showAllRoutes,\n      vehicleColors\n    } = settings;\n\n    return (\n      <div id='App' className=\"App\">\n        {\n          activeFeatures !== null ?\n            <FeatureSideBar\n              hosts={hosts}\n              activeFeatures={activeFeatures}\n              vehicles={vehicles}\n              setActiveFeatures={setActiveFeatures} />\n            : null\n        }\n\n        <div id='main-content'>\n          <NavBar\n            solutionStatus={solutionStatus}\n            loadSolution={loadSolution}\n            setDays={setDays}\n            setVehicles={setVehicles}\n            setWeeks={setWeeks}\n            setShowRoutes={setShowRoutes}\n\n            getVehiclesByDays={getVehiclesByDays}\n            getVehiclesByWeeks={getVehiclesByWeeks}\n            getDaysByVehicles={getDaysByVehicles}\n            getWeeksByVehicles={getWeeksByVehicles}\n\n            vehiclesPerDay={vehiclesPerDay}\n            vehiclesPerWeek={vehiclesPerWeek}\n            vehicles={vehicles}\n\n            activeFilter={activeFilter}\n            activeDays={activeDays}\n            activeWeeks={activeWeeks}\n            activeVehicles={activeVehicles}\n            showAllRoutes={showAllRoutes}\n            vehicleColors={vehicleColors} />\n\n          <Mapbox\n            activeFilter={activeFilter}\n            activeVehicles={activeVehicles}\n            showAllRoutes={showAllRoutes}\n            vehicles={vehicles}\n            hosts={hosts}\n            vehicleColors={vehicleColors}\n            vehiclesPerDay={vehiclesPerDay}\n            vehiclesPerWeek={vehiclesPerWeek}\n            setActiveFeatures={setActiveFeatures} />\n        </div>\n\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state, props) => {\n  const { settings, solution } = state;\n\n  return {\n    settings,\n    solution: {\n      getVehiclesByDays: days => SolutionSelectors.getVehiclesByDays(state, days),\n      getVehiclesByWeeks: weeks => SolutionSelectors.getVehiclesByWeeks(state, weeks),\n      getDaysByVehicles: vehicles => SolutionSelectors.getDaysByVehicles(solution, vehicles),\n      getWeeksByVehicles: vehicles => SolutionSelectors.getWeeksByVehicles(solution, vehicles),\n      ...solution\n    }\n  };\n};\nconst mapDispatchToProps = (dispatch, props) => ({\n  // Settings\n  setVehicles: vehicles => dispatch(SettingsActions.setVehicles(vehicles)),\n  setWeeks: weeks => dispatch(SettingsActions.setWeeks(weeks)),\n  setDays: days => dispatch(SettingsActions.setDays(days)),\n\n  setActiveFeatures: features => dispatch(SettingsActions.setActiveFeatures(features)),\n  setShowRoutes : showAllRoutes => dispatch(SettingsActions.setShowRoutes(showAllRoutes)),\n  \n  // Solution\n  loadSolution: file => dispatch(SolutionActions.loadSolution(file))\n});\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(App);","import {\n  SET_ACTIVE_FEATURES,\n  SET_VEHICLE_COLORS,\n  SET_SHOW_ROUTES,\n  SET_FILTER,\n  Filters\n} from './types';\n\n\nconst initialState = {\n  activeFeatures: null,\n  activeFilter: Filters.WEEK,\n  activeWeeks: null,\n  activeDays: null,\n  activeVehicles: [],\n\n  showAllRoutes: false,\n  vehicleColors: []\n};\n\nexport default (state = initialState, { type, payload }) => {\n  switch(type) {\n    case SET_SHOW_ROUTES:\n      const { showAllRoutes } = payload;\n\n      return {\n        ...state,\n        showAllRoutes\n      };\n    case SET_ACTIVE_FEATURES:\n      return {\n        ...state,\n        activeFeatures: payload\n      };\n    case SET_VEHICLE_COLORS:\n      const { vehicleColors } = payload;\n\n      return {\n        ...state,\n        vehicleColors\n      };\n    case SET_FILTER:\n      const { activeFilter, activeWeeks, activeDays, activeVehicles } = payload;\n\n      return {\n        ...state,\n        activeFilter,\n        activeWeeks,\n        activeDays,\n        activeVehicles\n      };\n    default:\n      return state;\n  }\n}\n","import { SET_STATUS, LOAD_SOLUTION, LoadStatus } from './types';\n\nconst initialState = {\n  status: LoadStatus.EMPTY,\n  hosts: [],\n  vehicles: [],\n  vehiclesPerDay: [],\n  vehiclesPerWeek: []\n};\n\nexport default (state = initialState, { type, payload }) => {\n  switch(type) {\n    case SET_STATUS:\n      return { ...state, status: payload.status };\n    case LOAD_SOLUTION:\n      const { hosts, vehicles, vehiclesPerDay, vehiclesPerWeek } = payload;\n\n      return {\n        status: LoadStatus.DONE,\n        hosts,\n        vehicles,\n        vehiclesPerDay,\n        vehiclesPerWeek\n      };\n    default:\n      return state;\n  }\n};\n","import { combineReducers } from 'redux';\nimport SettingsReducer from './settings/reducer';\nimport SolutionReducer from './solution/reducer';\n\nconst rootReducer = combineReducers({\n  settings: SettingsReducer,\n  solution: SolutionReducer\n});\n\nexport default rootReducer;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\n\nimport './index.css';\nimport App from './App';\n\nimport { initStore } from './store';\n\nconst store = initStore();\n\nReactDOM.render(\n  <Provider store={store} >\n    <App />\n  </Provider>,\n  document.getElementById('root')\n);\n","import { createStore, applyMiddleware } from 'redux';\nimport thunk from 'redux-thunk';\nimport { composeWithDevTools } from 'redux-devtools-extension'\nimport reducer from './reducers';\n\nconst isDev = process.env.NODE_ENV === 'development';\n\nexport const initStore = (initialState = {}) => {\n  return createStore(\n    reducer,\n    initialState,\n    isDev ?\n      composeWithDevTools(applyMiddleware(thunk)) :\n      applyMiddleware(thunk)\n  );\n};"],"sourceRoot":""}